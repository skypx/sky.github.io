<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Skypx</title>
    <meta name="description" content="">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_8v3czwksspqlg14i.css">
    <link rel="stylesheet" href="/css/main.css ">
    <link rel="canonical" href="http://localhost:4000/">
    <link rel="alternate" type="application/rss+xml" title="Skypx" href="http://localhost:4000/feed.xml ">



    <script>
    // google analytics
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-72449510-4', 'auto');
      ga('send', 'pageview');

    </script>



</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">Skypx</a>
        <small>Talk is cheap，show me the code</small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a class="active" href="/">
                        
                        <i class="fa fa-home"></i>主页
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>文章
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>类型
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/tag/">
                        
                            <i class="fa fa-tags"></i>标签
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/about/">
                        
                            <i class="fa fa-heart"></i>关于
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" index>
    <div class="left">
        <h1>Welcome to Sky's Blog!</h1>
        <small>当你的才华配不上你的理想的时候, 就静下心来好好学习!</small>
        <hr>
        <ul>
            
              <li>
                <h2>
                  <a class="post-link" href="/2019/06/14/data_Linux&Mac&history/">Linux 和 Mac下快速搜索历史命令</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2019-06-14
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#工具" title="Category: 工具" rel="category">工具</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#Linux" title="Tag: Linux" rel="tag">Linux</a>&nbsp;
    
        <a href="/tag/#与" title="Tag: 与" rel="tag">与</a>&nbsp;
    
        <a href="/tag/#Mac" title="Tag: Mac" rel="tag">Mac</a>&nbsp;
    
        <a href="/tag/#搜索历史命令" title="Tag: 搜索历史命令" rel="tag">搜索历史命令</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    
<blockquote>
  <p>在Linux 或者 Mac系统中如何快速搜索已经使用过的命令?</p>
</blockquote>

<ul>
  <li>
    <p>在Linux中我们可以用history查询已经使用过的命令</p>
  </li>
  <li>
    <p>并且还可以用 Ctrl + R 来搜索已经用过的命令</p>
  </li>
  <li>
    <p>我们用一种更快的方式来搜索, 你忘记了以前输入过的某个命令, 只记得开头的几个字母, 没关系
 下面我们看看怎么快速补全</p>
  </li>
</ul>

<ol>
  <li>进入你的用户目录下.建立.inputrc文件</li>
  <li>
    <p>输入以下内容</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="s">"\e[A"</span><span class="o">:</span> <span class="n">history</span><span class="o">-</span><span class="n">search</span><span class="o">-</span><span class="n">backward</span>
 <span class="s">"\e[B"</span><span class="o">:</span> <span class="n">history</span><span class="o">-</span><span class="n">search</span><span class="o">-</span><span class="n">forward</span>
 <span class="n">set</span> <span class="n">show</span><span class="o">-</span><span class="n">all</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="n">ambiguous</span> <span class="n">on</span>
 <span class="n">set</span> <span class="n">completion</span><span class="o">-</span><span class="n">ignore</span><span class="o">-</span><span class="k">case</span> <span class="n">on</span>
</code></pre></div>    </div>
  </li>
  <li>保存, 执行 bind -f .inputrc</li>
</ol>

<p>然后你随便输入几个命令. ls, pwd, cd, ….
这个时候想输入pwd, 只用输入p 然后按键盘上键, 命令自动补充完毕. 大大提升工作效率!!</p>

                </div>
                <div class="read-all">
                    <a  href="/2019/06/14/data_Linux&Mac&history/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2019/06/14/data_androidtargetsdk/">关于minsdk, targetsdk, maxsdk</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2019-06-14
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#Android" title="Category: Android" rel="category">Android</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#Android" title="Tag: Android" rel="tag">Android</a>&nbsp;
    
        <a href="/tag/#SDK" title="Tag: SDK" rel="tag">SDK</a>&nbsp;
    
        <a href="/tag/#区别" title="Tag: 区别" rel="tag">区别</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#语法" id="markdown-toc-语法">语法</a></li>
  <li><a href="#属性" id="markdown-toc-属性">属性</a>    <ul>
      <li><a href="#androidminsdkversion" id="markdown-toc-androidminsdkversion"><code class="highlighter-rouge">android:minSdkVersion</code></a></li>
      <li><a href="#androidtargetsdkversion" id="markdown-toc-androidtargetsdkversion"><code class="highlighter-rouge">android:targetSdkVersion</code></a></li>
      <li><a href="#androidmaxsdkversion" id="markdown-toc-androidmaxsdkversion"><code class="highlighter-rouge">android:maxSdkVersion</code></a></li>
    </ul>
  </li>
  <li><a href="#总结" id="markdown-toc-总结">总结</a>    <ul>
      <li><a href="#参考google" id="markdown-toc-参考google">参考Google:</a></li>
      <li><a href="#窥一斑而知全貌下面是网上看到的一个总结挺好的" id="markdown-toc-窥一斑而知全貌下面是网上看到的一个总结挺好的">窥一斑而知全貌,下面是网上看到的一个总结挺好的:</a>        <ul>
          <li><a href="#targetsdkversion24--手机的版本60" id="markdown-toc-targetsdkversion24--手机的版本60">targetSdkVersion（24） &gt; 手机的版本（6.0）</a></li>
          <li><a href="#手机的版本--targetsdkversion" id="markdown-toc-手机的版本--targetsdkversion">手机的版本 &gt; targetSdkVersion</a></li>
          <li><a href="#手机的版本--targetsdkversion-1" id="markdown-toc-手机的版本--targetsdkversion-1">手机的版本 = targetSdkVersion</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>详解targetsdk</p>
</blockquote>

<h2 id="语法">语法</h2>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">uses</span><span class="o">-</span><span class="n">sdk</span> <span class="nl">android:</span><span class="n">minSdkVersion</span><span class="o">=</span><span class="s">"integer"</span>
          <span class="nl">android:</span><span class="n">targetSdkVersion</span><span class="o">=</span><span class="s">"integer"</span>
          <span class="nl">android:</span><span class="n">maxSdkVersion</span><span class="o">=</span><span class="s">"integer"</span> <span class="o">/&gt;</span>
</code></pre></div></div>
<h2 id="属性">属性</h2>
<h3 id="androidminsdkversion"><code class="highlighter-rouge">android:minSdkVersion</code></h3>

<p>一个用于指定应用运行所需最低 API 级别的整数。 如果系统的 API 级别低于该属性中指定的值，Android 系统将阻止用户安装应用。 您应该始终声明该属性.</p>

<p>注意：如果您不声明该属性，系统将假定默认值为“1”，这表示您的应用兼容所有 Android 版本。 如果您的应用并不兼容所有版本（例如，它使用 API 级别 3 中引入的 API），并且您尚未声明正确的 minSdkVersion，则当应用安装在 API 级别小于 3 的系统上时，应用将在运行时尝试访问不可用的 API 时发生崩溃。 因此，请务必在 minSdkVersion 属性中声明合适的 API 级别。</p>

<h3 id="androidtargetsdkversion"><code class="highlighter-rouge">android:targetSdkVersion</code></h3>

<p>一个用于指定应用的目标 API 级别的整数。如果未设置，其默认值与为 minSdkVersion 指定的值相等。
该属性用于通知系统，您已针对目标版本进行测试，并且系统不应启用任何兼容性行为来保持您的应用与目标版本的向前兼容性。 应用仍可在较低版本上运行（最低版本为 minSdkVersion）。</p>

<p>在 Android 随着每个新版本的推出而进化的过程中，一些行为甚至是外观可能会发生变化。不过，如果平台的 API 级别高于您的应用的 targetSdkVersion 所声明的版本，系统就可以通过启用兼容性行为来确保您的应用继续以您所期望的方式工作。 您可以通过将 targetSdkVersion 指定为与应用所运行平台的 API 级别一致来停用此类兼容性行为。 例如，如果将该值设置为“11”或更高，系统便可在您的应用运行在 Android 3.0 或更高版本的平台上时对其应用新的默认主题 (Holo)，还可在您的应用运行在更大屏幕上时停用屏幕兼容性模式（因为对 API 级别 11 的支持隐含了对更大屏幕的支持）。</p>

<p>系统可根据您为该属性设置的值启用许多兼容性行为。 Build.VERSION_CODES 参考资料中的相应平台版本对其中的几种行为做了说明。</p>

<p>要让您的应用与各 Android 版本保持同步，您应该增加该属性的值，使其与最新 API 级别一致，然后在相应平台版本上对您的应用进行全面测试。</p>

<p>引入的版本：API 级别 4</p>

<h3 id="androidmaxsdkversion"><code class="highlighter-rouge">android:maxSdkVersion</code></h3>

<p>一个指定作为应用设计运行目标的最高 API 级别的整数。
在 Android 1.5、1.6、2.0 及 2.0.1 中，系统会在安装应用以及系统更新后重新验证应用时检查该属性的值。 在任一情况下，如果应用的 maxSdkVersion 属性低于系统本身使用的 API 级别，系统均不允许安装应用。 在系统更新后重新验证这种情况下，这实际上相当于将您的应用从设备中移除。</p>

<p>为说明该属性在系统更新后对您的应用的影响，请看看下面这个示例：</p>

<p>Google Play 上发布了一个在其清单中声明了 maxSdkVersion=”5” 的应用。 一位设备运行 Android 1.6（API 级别 4）的用户下载并安装了该应用。 几周后，该用户收到了 Android 2.0（API 级别 5）OTA 系统更新。 更新安装后，系统检查该应用的 maxSdkVersion 并顺利完成了对其的重新验证。 应用仍可照常工作。 不过，一段时间后，设备又收到了一个系统更新，这次是更新到 Android 2.0.1（API 级别 6）。 更新完成后，系统无法再重新验证应用，因为此时系统本身的 API 级别 (6) 已超过该应用支持的最高级别 (5)。 系统会使该应用对用户不可见，这实际上相当于将它从设备上删除。</p>

<p>警告：不建议声明该属性。 首先，没有必要设置该属性，将其作为阻止您的应用部署到 Android 平台新发布版本上的一种手段。 从设计上讲，新版本平台完全向后兼容。 只要您的应用只使用标准 API 并遵循部署最佳实践，应该能够在新版本平台上正常工作。 其次，请注意在某些情况下，声明该属性可能导致您的应用在系统更新至更高 API 级别后被从用户设备中移除。 大多数可能安装您的应用的设备都会定期收到 OTA 系统更新，因此您应该在设置该属性前考虑这些更新对您的应用的影响。</p>

<h1 id="总结">总结</h1>

<h2 id="参考google">参考Google:</h2>
<p><a href="https://developer.android.com/guide/topics/manifest/uses-sdk-element.html?hl=zh-cn">Targetsdk</a></p>

<ul>
  <li>minSdkVersion 和 maxSdkVersion 还好理解. 下面我重点说下tagetSdkVersion</li>
</ul>

<p>下面我举个列子: (以运行时权限为例子)
我有一个Android 6.0 系统的手机. 我写了一个app</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">uses</span><span class="o">-</span><span class="n">sdk</span> <span class="nl">android:</span><span class="n">minSdkVersion</span><span class="o">=</span><span class="s">"15"</span>
          <span class="nl">android:</span><span class="n">targetSdkVersion</span><span class="o">=</span><span class="s">"28"</span>
          <span class="nl">android:</span><span class="n">maxSdkVersion</span><span class="o">=</span><span class="s">"28"</span> <span class="o">/&gt;</span>
</code></pre></div></div>
<p>这个时候毫无疑问我运行app的时候需要适配运行时权限的代码, 那巧了, 我不想写运行时权限的代码怎么办
可以, 你只需要把targetSdkVersion 设置小于23就可以了
为什么要设置小于23就可以了?</p>

<ul>
  <li>我们可以参考下链接:</li>
</ul>
<p><a href="http://androidxref.com/9.0.0_r3/xref/frameworks/base/core/java/android/content/res/Resources.java#161">http://androidxref.com/9.0.0_r3/xref/frameworks/base/core/java/android/content/res/Resources.java#161</a></p>

<p>可以看到里面根据了targetsdk的不同而设置了不一样的主题. 其实targetsdk就是为了设置兼容性的.
来确保你的App在新平台上面是否运行一些新特性.</p>

<h2 id="窥一斑而知全貌下面是网上看到的一个总结挺好的">窥一斑而知全貌,下面是网上看到的一个总结挺好的:</h2>
<h3 id="targetsdkversion24--手机的版本60">targetSdkVersion（24） &gt; 手机的版本（6.0）</h3>
<p>对应项目会运行手机版本内一切特性。譬如项目targetSdkVersion是24，那么项目里没做6.0权限管理，调用危险权限相机就会闪退（利大于弊）</p>

<h3 id="手机的版本--targetsdkversion">手机的版本 &gt; targetSdkVersion</h3>
<p>项目运行效果为targetSdkVersion 版本。譬如项目targetSdkVersion是22，那么项目里没做6.0（23）权限处理，调用危险权限如相机不会出现闪退和提示，照常运行，项目特性运行到22版本。</p>

<h3 id="手机的版本--targetsdkversion-1">手机的版本 = targetSdkVersion</h3>
<p>如果目标设备的API版本正好等于此数值， 他会告诉Android平台：此程序在此版本已经经过充分测，没有问题。不必为此程序开启兼容性检查判断的工作了。 也就是说，如果targetSdkVersion与目标设备的API版本相同时，运行效率可能会高一些。 但是，这个设置仅仅是一个声明、一个通知，不会有太实质的作用
用较低的 minSdkVersion 来覆盖最大的人群，用最新的 SDK 设置 targetSdkVersion和 compile 来获得最好的外观和行为。强烈推荐targetSdkVersion升到最新版本。</p>

<p>参考: <a href="https://www.jianshu.com/p/26eff76f7883">https://www.jianshu.com/p/26eff76f7883</a></p>

                </div>
                <div class="read-all">
                    <a  href="/2019/06/14/data_androidtargetsdk/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2019/06/12/data_markdown%E8%AF%AD%E6%B3%95/">Markdown语法</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2019-06-12
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#工具" title="Category: 工具" rel="category">工具</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#Camera" title="Tag: Camera" rel="tag">Camera</a>&nbsp;
    
        <a href="/tag/#API" title="Tag: API" rel="tag">API</a>&nbsp;
    
        <a href="/tag/#区别" title="Tag: 区别" rel="tag">区别</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#这个网站也有一些命令" id="markdown-toc-这个网站也有一些命令">这个网站也有一些命令</a></li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="o">.</span> <span class="err">标题加粗</span> <span class="o">:</span> <span class="err">#</span>
<span class="mi">2</span><span class="o">.</span> <span class="err">引用图片资源</span><span class="o">:</span> <span class="o">![</span><span class="n">avatar</span><span class="o">](</span><span class="n">url</span><span class="o">)</span>
<span class="mi">3</span><span class="o">.</span> <span class="err">列表</span><span class="o">:</span>
   <span class="err">第一种方式</span><span class="o">:</span> <span class="o">*</span>
   <span class="err">第二种方式</span><span class="o">:</span> <span class="mi">1</span><span class="o">.</span> <span class="mi">2</span><span class="o">.</span> <span class="err">这种方式</span>
<span class="mi">4</span><span class="o">.</span> <span class="err">表格</span><span class="o">:</span> <span class="err">上面</span><span class="o">---,</span> <span class="err">下面是</span><span class="o">---,</span> <span class="err">像下面这样</span>

  <span class="o">---</span>
  <span class="nl">layout:</span> <span class="n">post</span>
  <span class="nl">title:</span> <span class="n">Markdown</span><span class="err">语法</span>
  <span class="nl">category:</span> <span class="err">工具</span>
  <span class="nl">tags:</span> <span class="n">Camera</span> <span class="n">API</span> <span class="err">区别</span>
  <span class="o">---</span>

<span class="mi">5</span><span class="o">.</span><span class="err">超链接有两种方式</span>
  <span class="err">第一种</span><span class="o">:</span> <span class="o">[</span><span class="err">菜鸟教程</span><span class="o">](</span><span class="nl">https:</span><span class="c1">//www.runoob.com)</span>
  <span class="err">第二种</span><span class="o">:</span> <span class="o">&lt;</span><span class="nl">https:</span><span class="c1">//www.runoob.com&gt;</span>

<span class="mi">6</span><span class="o">.</span><span class="err">如果换行的话在行末加两个空格</span>

<span class="mi">7</span><span class="o">.&gt;</span> <span class="err">这是引用</span>
</code></pre></div></div>

<h1 id="这个网站也有一些命令">这个网站也有一些命令</h1>
<p><a href="https://www.runoob.com/markdown/md-tutorial.html">菜鸟教程</a>
<a href="https://www.runoob.com/markdown/md-tutorial.html">https://www.runoob.com/markdown/md-tutorial.html</a></p>

<p>持续更新…</p>

                </div>
                <div class="read-all">
                    <a  href="/2019/06/12/data_markdown%E8%AF%AD%E6%B3%95/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2019/06/12/data_camerazsl/">Camera ZSL 拍照</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2019-06-12
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#Camera" title="Category: Camera" rel="category">Camera</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#Camera" title="Tag: Camera" rel="tag">Camera</a>&nbsp;
    
        <a href="/tag/#拍照" title="Tag: 拍照" rel="tag">拍照</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#什么是zsl" id="markdown-toc-什么是zsl">什么是ZSL</a></li>
  <li><a href="#针对api1来说" id="markdown-toc-针对api1来说">针对API1来说</a></li>
  <li><a href="#针对api2来说" id="markdown-toc-针对api2来说">针对API2来说</a></li>
  <li><a href="#具体的code方式" id="markdown-toc-具体的code方式">具体的code方式</a></li>
</ul>

<h1 id="什么是zsl">什么是ZSL</h1>
<ul>
  <li>
    <p>ZSL (zero shutter lag)：零秒延迟</p>
  </li>
  <li>
    <p>在日常生活中，使用手机camera拍照的时候往往会有一些延迟的体验。ZSL，就是为了消除这种延迟，提供一种“拍即视”的体验而被开发出来。</p>
  </li>
</ul>

<p><a href="http://blog.chinaunix.net/uid-7213935-id-5753468.html">ZSL链接</a></p>

<h1 id="针对api1来说">针对API1来说</h1>
<ul>
  <li>高通会提供关于ZSL的patch给厂商. 厂商通过设置 <code class="highlighter-rouge">setZSLMode</code> 默认是隐藏的方法. 具体对于队列的维护
放在了Framework层去处理</li>
</ul>

<h1 id="针对api2来说">针对API2来说</h1>
<ul>
  <li>
    <p>Goolge建议对于缓存队列的处理放在App 层来处理 具体可以参考如下的链接
<a href="http://androidxref.com/9.0.0_r3/search?q=%22zsl%22&amp;project=packages">Camera2 ZSL</a></p>

    <p>这里要注意的是需要设置模板<code class="highlighter-rouge">TEMPLATE_ZERO_SHUTTER_LAG</code> 来通知HAL切换模板</p>
  </li>
</ul>

<h1 id="具体的code方式">具体的code方式</h1>

<ol>
  <li>创建Session的方式 <code class="highlighter-rouge">createReprocessableCaptureSessionByConfigurations</code>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">camera</span><span class="o">.</span><span class="na">createReprocessableCaptureSessionByConfigurations</span><span class="o">(</span><span class="n">inputConfiguration</span><span class="o">,</span> <span class="n">outputs</span><span class="o">,</span><span class="n">sessionListener</span><span class="o">,</span> <span class="n">handler</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
  <li>设置<code class="highlighter-rouge">InputConfiguration</code>, 还有<code class="highlighter-rouge">ImageWrite</code>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">InputConfiguration</span> <span class="n">inputConfiguration</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InputConfiguration</span>
                           <span class="n">Size</span><span class="o">.</span><span class="na">width</span><span class="o">(),</span> <span class="n">Size</span><span class="o">.</span><span class="na">height</span><span class="o">(),</span>
                           <span class="n">ImageFormat</span><span class="o">.</span><span class="na">YUV_420_888</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
  <li>创建新的ImageReader来配置和InputConfiguration一样的参数
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">ImageReader</span> <span class="n">mZslImageReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ImageReader</span><span class="o">(</span><span class="n">Size</span><span class="o">.</span><span class="na">width</span><span class="o">(),</span> <span class="n">Size</span><span class="o">.</span><span class="na">height</span><span class="o">(),</span>
                           <span class="n">ImageFormat</span><span class="o">.</span><span class="na">PRIVATE</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
  <li>把zslIamgereader传入setRepeatingBurst, 这样就可以获取这个流了
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">CaptureRequest</span><span class="o">.</span><span class="na">Builder</span> <span class="n">reqBuilder</span> <span class="o">=</span> <span class="n">cameraDevice</span><span class="o">.</span><span class="na">createCaptureRequest</span><span class="o">(</span><span class="n">templateType</span><span class="o">);</span>
  <span class="n">reqBuilder</span><span class="o">.</span><span class="na">addTarget</span><span class="o">(</span><span class="n">mZslImageReader</span><span class="o">.</span><span class="na">getSurface</span><span class="o">);</span>
  <span class="n">mCaptureSession</span><span class="o">.</span><span class="na">setRepeatingBurst</span><span class="o">(</span><span class="n">reqBuilder</span><span class="o">....);</span>
</code></pre></div>    </div>
  </li>
  <li>设置ZslImageReader的callback. onImageAvailable 可用的时候放入对列
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">private</span> <span class="kd">final</span> <span class="n">LinkedBlockingQueue</span><span class="o">&lt;</span><span class="n">Image</span><span class="o">&gt;</span> <span class="n">mQueue</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedBlockingQueue</span><span class="o">&lt;</span><span class="n">Image</span><span class="o">&gt;();</span>
  <span class="n">mQueue</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Image</span><span class="o">)</span>
</code></pre></div>    </div>
    <p><a href="http://androidxref.com/9.0.0_r3/xref/cts/tests/camera/utils/src/android/hardware/camera2/cts/CameraTestUtils.java#286">参考CTS</a></p>
  </li>
  <li>设置ImageWriter
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="err">这个</span><span class="n">surface</span><span class="err">其实就是设置</span><span class="n">inputconfig</span><span class="err">的时候底层创建的</span><span class="n">surface</span>
  <span class="n">ImageWriter</span> <span class="n">mImageWriter</span> <span class="o">=</span> <span class="n">ImageWriter</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">session</span><span class="o">.</span><span class="na">getInputSurface</span><span class="o">(),</span> <span class="mi">2</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
  <li>把LinkedBlockingQueue里面的image送给下面去重新操作, 同时把result也放入进去
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">mImageWriter</span><span class="o">.</span><span class="na">queueInputImage</span><span class="o">(</span><span class="n">mQueue</span><span class="o">.</span><span class="na">getImage</span><span class="o">());</span><span class="c1">//伪代码</span>
  <span class="n">captureRequestBuilder</span> <span class="o">=</span> <span class="n">mCameraDevice</span><span class="o">.</span>
                           <span class="nf">createReprocessCaptureRequest</span><span class="o">(</span><span class="n">mQueue</span><span class="o">.</span><span class="na">getResult</span><span class="o">());</span>
</code></pre></div>    </div>
  </li>
  <li>重新去拍照, 用图片的ImageReader
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">captureRequestBuilder</span><span class="o">.</span><span class="na">addTarget</span><span class="o">(</span><span class="n">mCaptureImageReader</span><span class="o">.</span><span class="na">getSurface</span><span class="o">());</span>
  <span class="n">mCaptureSession</span><span class="o">.</span><span class="na">capture</span><span class="o">(</span><span class="n">captureRequestBuilder</span><span class="o">.</span><span class="na">build</span><span class="o">(),</span>
                           <span class="n">captureRequestCallback</span><span class="o">,</span> <span class="n">mCameraDeviceHandler</span><span class="o">.</span><span class="na">getDeviceThreadHandler</span><span class="o">());</span>
</code></pre></div>    </div>
  </li>
</ol>

<blockquote>
  <p>我整理了一张图片大致流程是这样的
  <img src="https://github.com/skypx/BlogResource/raw/master/camera/zslnew.png" alt="avatar" /></p>
</blockquote>


                </div>
                <div class="read-all">
                    <a  href="/2019/06/12/data_camerazsl/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2019/06/12/data_cameraAPI1_API2/">Camera API1 - API2</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2019-06-12
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#Camera" title="Category: Camera" rel="category">Camera</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#Camera" title="Tag: Camera" rel="tag">Camera</a>&nbsp;
    
        <a href="/tag/#API" title="Tag: API" rel="tag">API</a>&nbsp;
    
        <a href="/tag/#区别" title="Tag: 区别" rel="tag">区别</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#api-概述" id="markdown-toc-api-概述">API 概述</a></li>
  <li><a href="#api1-和-api2的流程对比" id="markdown-toc-api1-和-api2的流程对比">API1 和 API2的流程对比</a></li>
  <li><a href="#java-层代码比较" id="markdown-toc-java-层代码比较">Java 层代码比较</a></li>
  <li><a href="#camera-api1-主要类" id="markdown-toc-camera-api1-主要类">Camera API1 主要类</a></li>
  <li><a href="#fw代码" id="markdown-toc-fw代码">FW代码</a></li>
</ul>

<h1 id="api-概述">API 概述</h1>

<p>Android5.0之后，增加了Cameraapi2接口，api2和api1在调用流程上差异很大，功能上api2提供了更加细致的控制功能，api1子系统被设计为具备高级控制功能的黑盒，能够发出请求，但无法控制图像的缓冲区和元数据，无法再帧层面控制传感器的特性，无法通过访问和修改元数据信息（如3A信息）对捕获的帧应用任何增强功能，重新设计api2旨在大幅提高应用程序控制摄像头子系统的能力，性能也有一定的提升。</p>

<h1 id="api1-和-api2的流程对比">API1 和 API2的流程对比</h1>

<p><img src="https://github.com/skypx/BlogResource/raw/master/camera/ape_fwk_camera.png" alt="avatar" /></p>

<ul>
  <li>从图中可以看出在API1中java-&gt; jni -&gt; camera service -&gt; Hal, 但是在API2中 java -&gt; camera service -&gt; Hal
为什么呢? 这个地方我们可以单独放在后面讲
就是说java不通过jni可以直接和c++通信. 类似aidl的方式, 链接在下面
<a href="https://android.googlesource.com/platform/system/tools/aidl/+/brillo-m10-dev/docs/aidl-cpp.md">https://android.googlesource.com/platform/system/tools/aidl/+/brillo-m10-dev/docs/aidl-cpp.md</a></li>
</ul>

<h1 id="java-层代码比较">Java 层代码比较</h1>
<h1 id="camera-api1-主要类">Camera API1 主要类</h1>

<ul>
  <li>Camera api1调用流程比较直观，也利于理解一些，应用程序实例化camera这一个类就可以控制摄像头子系统
    <ol>
      <li>Camera，api1主要类。通过类的这些startPreview、takePicture、AutoFocus等标准的接口实现</li>
      <li>Parameters，参数设置，通过camera内部类Parameters操作实现，如设置帧率，设置图片格式，预览尺寸等</li>
      <li>CameraInfo，元数据获取，通过camera内部类CameraInfo实现，这里只能获取不能修改</li>
    </ol>
  </li>
  <li>Camera API2 主要类
    <ol>
      <li>Camera api2在应用层的调用要复杂一些，定义的类也比较多，这也说明对摄像头子系统控制的更加细腻了</li>
      <li>CameraManager：摄像头管理器。这是一个全新的系统管理器，专门用于检测系统摄像头、打开系统摄像头。除此之外，调用CameraManager的getCameraCharacteristics(String)方法即可获取指定摄像头的相关特性</li>
      <li>CameraCharacteristics：摄像头特性。该对象通过CameraManager来获取，用于描述特定摄像头所支持的各种特性</li>
      <li>CameraDevice：代表系统摄像头。该类的功能类似于早期的Camera类</li>
      <li>CameraCaptureSession：这是一个非常重要的API，当程序需要预览、拍照时，都需要先通过该类的实例创建Session。而且不管预览还是拍照， 也都是由该对象的方法进行控制的，其中控制预览的方法为setRepeatingRequest()；控制拍照的方法为capture()</li>
      <li>应用程序对整个摄像头管道的控制能力得到提升。每个拍摄请求会产生一个带有拍摄元数据的结果对象和一些图像数据缓 冲区</li>
    </ol>
  </li>
</ul>

<h1 id="fw代码">FW代码</h1>
<p>后续分析</p>

                </div>
                <div class="read-all">
                    <a  href="/2019/06/12/data_cameraAPI1_API2/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2019/06/11/data_Mac$Paste/">Mac 下的剪切操作</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2019-06-11
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#工具" title="Category: 工具" rel="category">工具</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#Mac" title="Tag: Mac" rel="tag">Mac</a>&nbsp;
    
        <a href="/tag/#剪切" title="Tag: 剪切" rel="tag">剪切</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#问题mac-下怎么剪切" id="markdown-toc-问题mac-下怎么剪切">问题(Mac 下怎么剪切)?</a></li>
  <li><a href="#mac-下的剪切方式" id="markdown-toc-mac-下的剪切方式">Mac 下的剪切方式</a></li>
  <li><a href="#mac快捷键大全" id="markdown-toc-mac快捷键大全">Mac快捷键大全</a></li>
</ul>
<h2 id="问题mac-下怎么剪切">问题(Mac 下怎么剪切)?</h2>
<ul>
  <li>Windows下为: Ctrl+x</li>
  <li>Mac下是否为: Cmd+x （答案是否定的）</li>
</ul>

<h2 id="mac-下的剪切方式">Mac 下的剪切方式</h2>
<ul>
  <li>首先<code class="highlighter-rouge">Command+C</code> 复制文件</li>
  <li>然后<code class="highlighter-rouge">Command＋Option＋V</code> 剪切文件</li>
</ul>

<h2 id="mac快捷键大全">Mac快捷键大全</h2>
<p><a href="http://support.apple.com/kb/HT13 ... CN&amp;locale=zh_CN">Mac快捷键</a></p>

<p><a href="http://support.apple.com/kb/HT13 ... CN&amp;locale=zh_CN">http://support.apple.com/kb/HT13 ... CN&amp;locale=zh_CN</a></p>

                </div>
                <div class="read-all">
                    <a  href="/2019/06/11/data_Mac$Paste/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
        </ul>



        <!-- Pagination links -->
        <div class="pagination">
          
            <span class="previous disable"><i class="fa fa-angle-double-left"></i></span>
            <span class="previous disable"><i class="fa fa-angle-left"></i></span>
          
          <span class="page_number ">1/1</span>
          
            <span class="next disable"><i class="fa fa-angle-right"></i></span>
            <span class="next disable"><i class="fa fa-angle-double-right"></i></span>
          
        </div>
    </div>
    <!-- <button class="anchor"><i class="fa fa-anchor"></i></button> -->
    <div class="right">
        <div class="wrap">
            <div class="side">
                <div>
                    <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                    Recent Posts
                </div>
                <ul class="content-ul" recent>
                    
                        <li><a href="/2019/06/14/data_Linux&Mac&history/">Linux 和 Mac下快速搜索历史命令</a></li>
                    
                        <li><a href="/2019/06/14/data_androidtargetsdk/">关于minsdk, targetsdk, maxsdk</a></li>
                    
                        <li><a href="/2019/06/12/data_markdown%E8%AF%AD%E6%B3%95/">Markdown语法</a></li>
                    
                        <li><a href="/2019/06/12/data_camerazsl/">Camera ZSL 拍照</a></li>
                    
                        <li><a href="/2019/06/12/data_cameraAPI1_API2/">Camera API1 - API2</a></li>
                    
                        <li><a href="/2019/06/11/data_Mac$Paste/">Mac 下的剪切操作</a></li>
                    
                </ul>
            </div>

            <!-- Content -->
            <div class="side ">
                <div>
                    <i class="fa fa-th-list"></i>
                    Categories
                </div>
                <ul class="content-ul" cate>
                    
                    <li>
                        <a href="/category/#工具" class="categories-list-item" cate="工具">
                            <span class="name">
                                工具
                            </span>
                            <span class="badge">3</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#Camera" class="categories-list-item" cate="Camera">
                            <span class="name">
                                Camera
                            </span>
                            <span class="badge">2</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#Android" class="categories-list-item" cate="Android">
                            <span class="name">
                                Android
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                </ul>
            </div>
            <!-- 其他div框放到这里 -->
            <div class="side">
                <div>
                    <i class="fa fa-tags"></i>
                    Tags
                </div>
                <div class="tags-cloud">
                    
                    
                    
                    

                    

                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Mac" style="font-size: 13.5pt; color: #444;">Mac</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#剪切" style="font-size: 9pt; color: #999;">剪切</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Camera" style="font-size: 18pt; color: #000;">Camera</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#API" style="font-size: 13.5pt; color: #444;">API</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#区别" style="font-size: 18pt; color: #000;">区别</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#拍照" style="font-size: 9pt; color: #999;">拍照</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Android" style="font-size: 9pt; color: #999;">Android</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#SDK" style="font-size: 9pt; color: #999;">SDK</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Linux" style="font-size: 9pt; color: #999;">Linux</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#与" style="font-size: 9pt; color: #999;">与</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#搜索历史命令" style="font-size: 9pt; color: #999;">搜索历史命令</a>
                    
                </div>
            </div>

            <!-- <div class="side">
                <div>
                    <i class="fa fa-external-link"></i>
                    Links
                </div>
                <ul  class="content-ul">

                </ul>
            </div> -->
        </div>
    </div>
</div>
<!-- <script src="/js/scroll.min.js " charset="utf-8"></script> -->
<!-- <script src="/js/pageContent.js " charset="utf-8"></script> -->


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
             本站记录我的 Android 之旅的沿途风景！ 
        </p>
        <p class="contact">
            Contact me at: 
            <a href="https://github.com/skypx" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a>  
            <a href="mailto:wpxwangshi@163.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a>        
        </p>
        <p>
            本站总访问量<span id="busuanzi_value_site_pv"></span>次，本站访客数<span id="busuanzi_value_site_uv"></span>人次，本文总阅读量<span id="busuanzi_value_page_pv"></span>次
        </p>
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
            <span>
                Theme designed by <a href="https://github.com/Gaohaoyang">HyG</a>.
            </span>
        </p>
    </div>
</footer>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script type="text/javascript" charset="utf-8" src="https://changyan.itc.cn/js/lib/jquery.js"></script>
    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/prism.js " charset="utf-8"></script>
    <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
    <script type="text/javascript">
      $('pre').addClass("line-numbers");
    </script>
    <!-- <script src=" /js/scroll.min.js " charset="utf-8"></script> -->
  </body>

</html>
